
<p>
In the beginning, I got a GPS. It wasn&#039;t waterproof, and I didn&#039;t have a way to transfer its data to a computer, so I mostly used it to tell me that I was about where I thought I was; I&#039;d only turn it on once an hour or so. Useful, but not earthshaking. It would tell me how fast I was going, too, and I almost ran into a tree stump on Lake Lewisville when I tried to take a picture of the stupid thing showing 11 knots and didn&#039;t see the tree fast approaching. “There has got,” I thought, “to be a better way to do this than this.”
</p>

<p>
Well, of course there is. A modern GPS which you leave on all the time you&#039;re sailing will happily download the data to a spreadsheet for you. Isn&#039;t that nice? I think it&#039;s nice. My friend Laurent has such a GPS, and he went sailing with me, and he sent me the files. They looked like this, when I opened them:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:original.jpg" class="media" title="kevin:skate:original.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:original.jpg" class="media" title="original.jpg" alt="original.jpg" width="500" /></a>
</p>

<p>
So, clearly this is not the most useful way to look at the data. For one thing, the headings are off. It&#039;s easy to fix that, and to delete columns you don&#039;t need. If you&#039;re interested in the boat&#039;s performance what you want is the course and the speed. Be careful, though! Look at column M. That&#039;s speed, right? Sure. In mph, fine. But it&#039;s rounded to the nearest integer. Whey you&#039;re going 4 mph and you&#039;re possibly off by as much as .5 mph, that&#039;s a .5/4 = .125 = 12.5% error! You don&#039;t want the speeds rounded to the nearest mph. What to do?
</p>

<p>
First, I don&#039;t use the lat and long data in the first few columns. No doubt one could, and other applications do, but I don&#039;t when I&#039;m just trying to chart something about boat performance. So get rid of those, and get rid of the altitude data, too, you don&#039;t need that. Highlight the columns of data and delete them, and label the remaining data columns correctly. You should now have this:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps00000.jpg" class="media" title="kevin:skate:gps00000.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps00000.jpg" class="media" title="gps00000.jpg" alt="gps00000.jpg" width="500" /></a>
</p>

<p>
Ok, that&#039;s nice. But the data is in a bad form to try to use it now. Column C is the time of each leg, but it&#039;s in HH:MM:SS format, that&#039;s no good. You want it just as an integer number of seconds. And column F is the course, but it has a ~ or something after each entry, that will also mess up trying to plot the data. So we have to fix that. First highlight column C, and pick the “Data” menu, then pick “Text to Columns”. Leave the first page checked as “Delimited”, go to page 2, check the box next to “space”, and next to “other”, then next to “other” put ”:”, so you have this:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps00001.jpg" class="media" title="kevin:skate:gps00001.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps00001.jpg" class="media" title="gps00001.jpg" alt="gps00001.jpg" width="500" /></a>
</p>

<p>
Click “Next”, go to page 3. Pick colum 1, column 2 and column 4, and for each click the “Do not import” button. So you have this:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps00002.jpg" class="media" title="kevin:skate:gps00002.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps00002.jpg" class="media" title="gps00002.jpg" alt="gps00002.jpg" width="500" /></a>
</p>

<p>
Note that only column 3 will be imported, that&#039;s the seconds. That&#039;s what we want. Click “Finish”, and you get this:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps00003.jpg" class="media" title="kevin:skate:gps00003.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps00003.jpg" class="media" title="gps00003.jpg" alt="gps00003.jpg" width="500" /></a>
</p>

<p>
Disaster! The data is all gone!
</p>

<p>
No it&#039;s not. The cells are still in HH:MM:SS format. You have to change them. Leave them highlighted, and select “Format”, then “Cells”, then from the menu select “General”. Then you should see only the seconds:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps00004.jpg" class="media" title="kevin:skate:gps00004.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps00004.jpg" class="media" title="gps00004.jpg" alt="gps00004.jpg" width="500" /></a>
</p>

<p>
Now to get rid of the ~ thing after the data, select column F, do “Text to Columns” again, this time copy the little ~ thing, paste it in as a seperator on page 2, and don&#039;t import it if it shows up as a column. So you end up with this:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps00005.jpg" class="media" title="kevin:skate:gps00005.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps00005.jpg" class="media" title="gps00005.jpg" alt="gps00005.jpg" width="500" /></a>
</p>

<p>
Ok, fine. You have the data in a reasonable form. Now you can make a graph; for example, an easy graph to make is just speed on one axis and course on the other. To do that here, highlight columns D and F, then click on the graph icon at the top, then select “X Y (scatter)”. then “Finish”. You should get something like this:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps00006.jpg" class="media" title="kevin:skate:gps00006.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps00006.jpg" class="media" title="gps00006.jpg" alt="gps00006.jpg" width="500" /></a>
</p>

<p>
Hey! A graph! Neat.
</p>

<p>
Ok, but it has some problems. One thing is what I noted at the beginning, that the speeds are all integers, that&#039;s not good. The second thing is that it&#039;s speed vs true course, when what&#039;s much more useful is speed vs course relative to the wind.
</p>

<p>
The first thing is easiest to fix. Make a column called “Distance (miles)”, one called “Time (hours)”, and one called “Speed (calculated) (mph)”.
</p>

<p>
Now, under “Distance (miles)”, you want to divide the distance in feet by 5280. Thus:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps00007.jpg" class="media" title="kevin:skate:gps00007.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps00007.jpg" class="media" title="gps00007.jpg" alt="gps00007.jpg" width="500" /></a>
</p>

<p>
(the = entered first tells Excel you&#039;re entering a formula). Hit “enter”, and go to the next cell. Under “Time (hours)”, I would enter ”=c11/3600”, since there are 3600 seconds in an hour. Now under “Speed”, I would enter ”= h11/i11”, and then enter. You should see this:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps00008.jpg" class="media" title="kevin:skate:gps00008.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps00008.jpg" class="media" title="gps00008.jpg" alt="gps00008.jpg" width="500" /></a>
</p>

<p>
Why look! We have a value for the speed that&#039;s not rounded off to the nearest integer. Neato.
</p>

<p>
Now highlight all 3 of those columns all the way down, and go to Edit -&amp;gt; Fill -&amp;gt; Down, or hit Ctrl-D. You should get:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps00009.jpg" class="media" title="kevin:skate:gps00009.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps00009.jpg" class="media" title="gps00009.jpg" alt="gps00009.jpg" width="500" /></a>
</p>

<p>
Now if you copy the course column to column K, highlight J and K, and make a graph, you get this:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps0000a.jpg" class="media" title="kevin:skate:gps0000a.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps0000a.jpg" class="media" title="gps0000a.jpg" alt="gps0000a.jpg" width="500" /></a>
</p>

<p>
Good, that&#039;s better, I guess. The speeds are not all rounded to the integer, you can see a bit better how they&#039;re actually distributed.
</p>

<p>
What we really want, though, is a polar, like this:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:polar000.jpg" class="media" title="kevin:skate:polar000.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:polar000.jpg" class="media" title="polar000.jpg" alt="polar000.jpg" width="500" /></a>
</p>

<p>
Neato, huh? It&#039;s useful to make a graph to predict how your boat will perform in various winds, as the above graph does for different wind strengths. I would be happy as a first step to just plot my data points in polar form like this, with windward at the top, and each point representing a speed at that heading.
</p>

<p>
To do that I need to take several steps:
</p>

<p>
Calculate the course off the wind, subtracting from the wind direction the day I was sailing
</p>

<p>
Convert the course off the wind to radians, since that&#039;s what the spreadsheet likes to use for the sin and cos functions.
</p>

<p>
Rotate the course off the wind so the polar will face up (otherwise, 0 radians or degrees would be to the right. It&#039;s usual to have 0 degrees off the wind at the top of the polar).
</p>

<p>
Finally, convert our “polar form” of speed and direction off the wind to a “rectangular form” point the spreadsheet will graph.
</p>

<p>
The columns I already have are:
</p>

<p>
Leg course (true)
</p>

<p>
leg length (miles)
</p>

<p>
leg time (hours)
</p>

<p>
leg speed (mph calculated)
</p>

<p>
The equations for the rest are:
</p>

<p>
Course off wind:
</p>

<p>
=140-[leg course true]
</p>

<p>
since my wind direction was 140
</p>

<p>
Course off wind in radians:
</p>

<p>
=[Course off wind]*3.14/180
</p>

<p>
Course off wind w wind direction up:
</p>

<p>
=[Course off wind in radians]+3.14/2
</p>

<p>
x axis:
</p>

<p>
=[leg speed (mph calculated)]*COS(Course off wind w wind direction up)
</p>

<p>
y axis:
</p>

<p>
=[leg speed (mph calculated)]*SIN(Course off wind w wind direction up)
</p>

<p>
Then highlight the last two columns and make a scatter plot. You should end up with something like this:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps0000b.jpg" class="media" title="kevin:skate:gps0000b.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps0000b.jpg" class="media" title="gps0000b.jpg" alt="gps0000b.jpg" width="500" /></a>
</p>

<p>
What the heck? Huh. It would appear that the GPS is under the impression I was going something like 60 knots at various times while sailing. Must have been windy. And because of those outliers, the rest of the graph is compressed and can&#039;t be seen.
</p>

<p>
What to do? Get rid of them, they&#039;re mistakes. Select the Data tab at the top of the page, and sort by your “leg speed (mph true)” column. Then go to the end and find where the thing is losing its mind; there will be a dozen or so entries with speeds that are clearly wrong. Highlight all those and delete all those rows of data.
</p>

<p>
Now do it again; select the two X-axis and Y-axis columns and make a graph (there&#039;s no need to re-order the data). Now it should look like this:
</p>

<p>
<a href="/wiki/lib/exe/detail.php?id=making_a_graph_from_gps_data&amp;media=kevin:skate:gps0000c.jpg" class="media" title="kevin:skate:gps0000c.jpg"><img src="/wiki/lib/exe/fetch.php?w=500&amp;media=kevin:skate:gps0000c.jpg" class="media" title="gps0000c.jpg" alt="gps0000c.jpg" width="500" /></a>
</p>

<p>
That, I must confess, is good enough for me. It can be read as a polar. It gives a pretty good picture of the sailing trip, if you look carefully. That big leg sticking out to the lower left was a very fast half day of broad reaching in big wind and flat water; there&#039;s really no way to reconcile that to the rest of the data, it was in different conditions. In constructing a standard polar set of curves such as the ones above I&#039;d throw it out and try to construct a curve that had the same wind and minimal wave conditions for all points of sail. But I think the above technique of just graphing all the points has something to be said for it too; it gives you a good look at that particular trip. This is a collection of all the points from five days of sailing, but I&#039;ve also made similar polars for each day.
</p>

<p>
Of course, once you&#039;ve done this once you can paste your new GPS data into it and have a new graph for each day in no time.
</p>

<p>
Hope this is helpful, and please email me or leave a comment if something is unclear.
</p>

<p>
Kevin O&#039;Neill
</p>
